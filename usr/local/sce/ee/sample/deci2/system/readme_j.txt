[SCEI CONFIDENTIAL DOCUMENT]
"PlayStation 2" Programmer Tool Runtime Library  Release 2.0
                  Copyright (C) 1999 by Sony Computer Entertainment Inc.
                                                     All Rights Reserved

DECI2 プロトコルを用いたホスト上の system() 関数を実行するサンプル


<サンプルの解説>
	このプログラムは、DECI2 プロトコルを用いてターゲット上の
	プログラムからホスト上の system() 関数を実行し、その結果を
	表示するサンプルプログラムです。

<ファイル>
	main.c        : ターゲット側のメインプログラム
	pdriver.c     : サンプルプロトコルドライバプログラム
	pdriver.h     : サンプルプロトコルドライバヘッダ
	linux/main.c  : ホスト側のメインプログラム
	linux/deci2.h : DECI2 プロトコルヘッダ
	linux/dcmp.h  : DCMP プロトコルヘッダ
	linux/netmp.h : NETMP プロトコルヘッダ

<起動方法>
	$ make		：コンパイル
	
	コンパイル後、
	$ cd linux
	$ ./hsys -d ターゲット名（または、IPアドレス）
	を実行し、他のウィンドウを開いて
	
	$ make run
	
	あるいは
	$ dsedb
	> run main.elf

<コントローラの操作方法>
	なし

<備考>
	今回定義したサンプルプロトコルは、プロトコル番号 = 0xe000 とし、
	DECI2 ヘッダに引き続き以下のような形式のパケットとなります。

       3                   2                   1                  
     1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                            Result                             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                                                          Data ...  |
                                                       -+-+-+-+-+-+-+

	Result 
	  ターゲットプログラムからのコマンド実行要求のときは 0 を、
	  ホストからの応答の時には system() の戻り値を設定します。

	Data
	  null-terminated された任意のデータです。
	  ターゲットプログラムからのコマンド実行要求のときはコマンド文字列
	  を、ホストからの応答の時には system() で実行されたコマンドの標準
	  出力結果を設定します。

<処理概略>
	処理の概略は、以下の通りです。

	ホスト側:
	1. dsnetm との TCP/IP レベルのコネクションを確立する
	2. netmp プロトコルの CONNECT メッセージを用いて、
	   deci2 レベルのコネクションを確立する
	3. ターゲットからの要求が来るまで無限に待つ
	4. ターゲットからのコマンド実行要求が来たら、コマンドを実行し、
	   その結果をテンポラリファイルに一旦セーブしてから、ターゲットに
	   返信する

	ターゲット側:
	1. プロトコルドライバを登録する
	2. コマンドをホストに送る
	3. コマンドの結果が返ってくるまで無限に待つ
	4. 結果が返ってきたら表示する 

